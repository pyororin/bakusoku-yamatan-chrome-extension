# やまたん爆速予約 (Yamatan Instant Booking)

山小屋予約サイト「やまたん」の予約プロセスを自動化し、カレンダー画面から“秒”で予約を完了させることを目的とした非公式Chrome拡張機能です。

## 主な機能

- **ログイン状態の自動判定**: サイトにログインしているかを確認します。
- **空きプランの自動検知**: 予約カレンダーから予約可能なプラン（`○/`で始まるもの）を自動で探し出します。
- **「即予約」ボタンの挿入**: 空きプランの横に「即予約」ボタンを動的に追加します。SPAの画面遷移（カレンダーの月移動など）にも追従します。
- **ワンクリック自動予約**:
  1.  「即予約」ボタンをクリックすると、予約ダイアログが自動で開きます。
  2.  あらかじめ設定した内容に基づき、プラン選択・人数選択が自動で行われます。
  3.  確認ページへ遷移後、事前に設定した質問項目（Q1〜Q4）が自動で入力されます。
  4.  最終的な同意ボタンが自動で押され、予約が完了します。
- **設定管理**: 拡張機能のオプションページで、自動入力させたい情報を簡単に設定・保存できます。設定のエクスポート/インポートも可能です。

---

## 導入手順

1. **リポジトリのダウンロード**:
   - このリポジトリのページの右上にある `[Code]` ボタンをクリックし、`Download ZIP` を選択してすべてのファイルをダウンロードします。
   - ダウンロードしたZIPファイルを解凍（展開）します。

2. **拡張機能のインストール**:
   - Google Chromeを開き、アドレスバーに `chrome://extensions` と入力して拡張機能管理ページにアクセスします。
   - 右上の **「デベロッパー モード」** をオンに切り替えます。
   - **「パッケージ化されていない拡張機能を読み込む」** ボタンをクリックします。
   - ファイル選択ダイアログが開くので、手順1で解凍したフォルダを選択します。
   - 「やまたん爆速予約」が一覧に追加されればインストール完了です。

---

## **【重要】** 利用前の必須設定

この拡張機能は、対象となるウェブサイトのドメイン（URL）を事前に知る必要があります。セキュリティのため、ご自身で設定していただく必要があります。

1. **`manifest.json`を開く**:
   - インストールしたフォルダの中にある `manifest.json` というファイルをテキストエディタで開きます。

2. **`host_permissions`を編集する**:
   - ファイル内に以下のような記述があります。

     ```json
     "host_permissions": [
       "https://*.example-yamatan.jp/*"
     ],
     ```

   - この `"https://*.example-yamatan.jp/*"` の部分を、実際の「やまたん」のウェブサイトのURLに書き換えてください。
   - 例えば、サイトのURLが `https://www.yamatan-goya.com` であれば、以下のように変更します。

     ```json
     "host_permissions": [
       "https://www.yamatan-goya.com/*"
     ],
     ```

3. **拡張機能をリロードする**:
   - `chrome://extensions` の管理ページに戻ります。
   - 「やまたん爆速予約」のカードにあるリロード（更新）アイコンをクリックして、変更を反映させます。

---

## 使い方

1. **設定ページを開く**:
   - Chromeのツールバーにある拡張機能アイコン（パズルのピースのような形）をクリックし、「やまたん爆速予約」を選択して設定ページを開きます。

2. **自動入力する情報を設定**:
   - **Q1〜Q4**の各項目に、予約時に自動入力したい内容を記入します。
   - 特に**Q1, Q2, Q3は必須**です。入力したら「保存」ボタンをクリックします。
   - よく使う設定は「エクスポート」でファイルに保存しておき、「インポート」で読み込むこともできます。

3. **予約サイトで自動予約**:
   - 設定後、「やまん」のサイトにアクセスし、ログインします。
   - 予約カレンダーのページを開くと、予約可能なプランの横に赤色の「即予約」ボタンが表示されます。
   - このボタンをクリックすると、あとはすべてのプロセスが自動で実行されます。処理中はボタンが「処理中...」に変わります。

## 既知の制約・注意事項

- この拡張機能は、「やまたん」のウェブサイトのHTML構造（DOM）に強く依存しています。サイト側でデザインやHTMLの構造が変更された場合、正常に動作しなくなる可能性があります。
- 予約処理は数秒で完了しますが、ネットワークの状況によっては時間がかかる場合があります。処理が完了するまでページを閉じないでください。

## 免責事項

- 本拡張機能は非公式のツールです。使用は自己責任でお願いします。
- 本拡張機能の使用により生じたいかなる損害についても、開発者は一切の責任を負いません。
- サイトの利用規約を遵守してご使用ください。自動化ツールの使用が規約で禁止されている場合は、本拡張機能の使用を中止してください。